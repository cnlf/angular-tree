"use strict";(function(){var e=angular.module("angularTree",[]);e.directive("uiTree",["$timeout",function(e){return{restrict:"AE",template:'\n                <ul class="angular-tree">\n                    <li ng-repeat="row in rowData | filter:{visible:true} track by row.branch._id" \n                   ng-class="{\'active\': row.branch.selected, \'tree-leaf\': row.isLeaf}"\n                    class="angular-tree-row level-{{row.level}}">\n                        <a ng-click="clickBranchHandler(row.branch)">\n                            <i ng-class="row.treeIcon" \n                            ng-click="row.branch.expanded = !row.branch.expanded" \n                            class="indented tree-icon"></i>\n                            <span class="indented tree-label">{{row.label}}</span>\n                        </a>\n                    </li>\n                </ul>',replace:!0,scope:{treeData:"=",treeControl:"=",onSelect:"&",initialSelection:"@"},link:function(n,r,t){function a(e){return e.children&&angular.isArray(e.children)&&e.children.length}function c(e){var r=function n(r,t){e(r,t),a(r)&&angular.forEach(r.children,function(e){n(e,t+1)})};angular.forEach(n.currData,function(e){r(e,1)})}function i(r){if(!r)return null!==f&&(f.selected=!1),void(f=null);if(!f||r.id!==f.id){if(null!==f&&(f.selected=!1),r.selected=!0,f=r,o(r),r.onSelect)return e(function(){return r.onSelect(r)});if(n.onSelect)return e(function(){return n.onSelect({branch:r})})}}function l(e){var n=void 0;return e._parentId&&c(function(r){if(r._id===e._parentId)return n=r}),n}function o(e){var n=function e(n,r){var t=l(n);t&&(r(t),e(t,r))};n(e,function(e){e.expanded=!0})}function u(){n.currData=[],angular.forEach(n.treeData,function(e){e&&n.currData.push(JSON.parse(JSON.stringify(e)))}),c(function(e,n){e._level=n,e.expanded=e._level<=s}),d()}function d(){function e(r,c,i){var l=void 0;c.expanded||(c.expanded=!1),c.noLeaf||a(c)?(c.isLeaf=!1,l=c.expanded?t.iconCollapse:t.iconExpand):(l=t.iconLeaf,c.isLeaf=!0),n.rowData.push({level:r,branch:c,label:c.label,isLeaf:c.isLeaf,treeIcon:l,visible:i}),a(c)&&angular.forEach(c.children,function(n){var t=i&&c.expanded;e(r+1,n,t)})}c(function(e){e._id||(e._id=Math.random().toString(16).substring(2)),e.children||(e.children=[]),a(e)&&angular.forEach(e.children,function(n){n._parentId=e._id})}),n.rowData=[],angular.forEach(n.currData,function(n){e(1,n,!0)})}var f=null,s=parseInt(t.expandLevel,10);return t.iconExpand||(t.iconExpand="fa fa-plus"),t.iconCollapse||(t.iconCollapse="fa fa-minus"),t.iconLeaf||(t.iconLeaf="fa fa-file-archive-o"),t.expandLevel||(t.expandLevel="3"),n.treeData&&angular.isArray(n.treeData)?(n.clickBranchHandler=function(e){f&&f.id===e.id||i(e)},n.currData=[],n.$watch("treeData",u,!0),n.$watch("currData",d,!0),void(n.treeControl&&angular.isObject(n.treeControl)&&!function(){var e=n.treeControl||{};e.expandAll=function(){return c(function(e){return e.expanded=!0})},e.collapseAll=function(){return c(function(e){return e.expanded=!1})},e.getFirstBranch=function(){var e=n.currData.length;return e>0?n.currData[0]:null},e.selectFirstBranch=function(){var n=e.getFirstBranch();return e.selectBranch(n)},e.getSelectedBranch=function(){return f},e.getParentBranch=function(n){return n||(n=e.getSelectedBranch()),l(n)},e.selectBranch=function(e){i(e)},e.selectParentBranch=function(n){if(n||(n=e.getSelectedBranch()),n){var r=e.getParentBranch(n);null!==r&&e.selectBranch(r)}},e.addBranch=function(e,r){null!==e?(e.children.push(r),e.expanded=!0):n.currData.push(r)},e.addRootBranch=function(n){e.addBranch(null,n)},e.expandBranch=function(){var n=e.getSelectedBranch();n?a(n)?n.expanded=!0:console.log("没有子节点"):console.log("请选择节点")},e.collapseBranch=function(){var n=e.getSelectedBranch();n?a(n)?n.expanded=!1:console.log("没有子节点"):console.log("请选择节点")},e.getSiblings=function(r){var t=void 0,a=void 0;a=r?r:e.getSelectedBranch();var c=e.getParentBranch(a);return t=c?c.children:n.currData},e.getNextSibling=function(n){if(n||(n=e.getSelectedBranch()),n){var r=e.getSiblings(n),t=r.length,a=r.indexOf(n);return a<t?r[a+1]||null:null}},e.getPrevSibling=function(n){n||(n=e.getSelectedBranch());var r=e.getSiblings(n),t=r.indexOf(n);if(t>0)return r[t-1]},e.selectNextSibling=function(n){if(n||(n=e.getSelectedBranch()),n){var r=e.getNextSibling(n);r&&e.selectBranch(r)}},e.selectPrevSibling=function(n){if(n||(n=e.getSelectedBranch()),n){var r=e.getPrevSibling(n);r&&e.selectBranch(r)}},e.getFirstChild=function(n){if(n||(n=e.getSelectedBranch()),n){var r=n.children;if(r&&r.length)return n.children[0]}},e.getClosestAncestorNextSibling=function(n){var r=e.getNextSibling(n);if(r)return r;var t=e.getParentBranch(n);return t?e.getClosestAncestorNextSibling(t):null},e.getNextBranch=function(n){if(n||(n=e.getSelectedBranch()),n){var r=e.getFirstChild(n);return r?r:e.getClosestAncestorNextSibling(n)}},e.selectNextBranch=function(n){if(n||(n=e.getSelectedBranch()),n){var r=e.getNextBranch(n);r&&e.selectBranch(r)}},e.lastDescendant=function(n){if(n){var r=n.children.length;if(0===r)return n;var t=n.children[r-1];return e.lastDescendant(t)}},e.getPrevBranch=function(n){if(n||(n=e.getSelectedBranch()),n){var r=e.getPrevSibling(n);return r?e.lastDescendant(r):e.getParentBranch(n)}},e.selectPrevBranch=function(n){if(n||(n=e.getSelectedBranch()),n){var r=e.getPrevBranch(n);if(r)return e.selectBranch(r)}}}())):void console.log("数据没有定义或不正确")}}}])}).call(window);
//# sourceMappingURL=tree-directive.min.js.map
